{
  "copilot_action_name": "LINUX-UFW-IP-UNBLOCK-COPILOT-ACTION",
  "description": "Unblocks a specified IPv4 address using UFW by removing any existing deny rules for the given IP. Validates the IP, checks if a block rule exists, and logs the result with detailed status and reason fields. Produces structured NDJSON output for auditing and writes atomically to the Active Response log with .new fallback if locked.",
  "technology": "Linux",
  "icon": "linux",
  "script_parameters": [
    {
      "name": "IP",
      "type": "string",
      "required": true,
      "description": "IPv4 address to unblock via UFW (e.g., 203.0.113.45).",
      "default": null,
      "arg_position" : "1"
    },
    {
      "name": "ARLog",
      "type": "string",
      "required": false,
      "description": "Active Response NDJSON output path (atomic overwrite; falls back to .new if locked).",
      "default": "/var/ossec/active-response/active-responses.log"
    },
    {
      "name": "LogPath",
      "type": "string",
      "required": false,
      "description": "Path to the rotating human-readable script log.",
      "default": "/tmp/Unblock-IP.log"
    },
    {
      "name": "LogMaxKB",
      "type": "integer",
      "required": false,
      "description": "Maximum size of the log file (KB) before rotation.",
      "default": 100
    },
    {
      "name": "LogKeep",
      "type": "integer",
      "required": false,
      "description": "Number of rotated log files to keep.",
      "default": 5
    }
  ],
  "repo_url": "https://raw.githubusercontent.com/socfortress/LINUX-UFW-IP-UNBLOCK-COPILOT-ACTION/refs/heads/main/",
  "script_name": "UFW-Unblock-ip.sh",
  "version": "1.0.0",
  "last_updated": "2025-08-23T00:00:00Z"
}
